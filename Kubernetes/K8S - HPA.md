# K8S - HPA

Kubernetes Horizontal Pod Autoscaler（HPA）是 Kubernetes 中用于自动扩缩 Pod 数量的资源对象。

### 1. 基本概念

- **HPA 的作用**：HPA 能够根据应用程序的负载情况自动调整 Pod 的副本数量。当负载升高时，自动增加 Pod 副本以提高处理能力；当负载降低时，减少 Pod 副本以节省资源，从而实现资源的高效利用和应用的弹性伸缩。
- **工作原理**：HPA 通过监控目标资源（如 Deployment、ReplicaSet 等）的性能指标（如 CPU 使用率、内存使用率、自定义指标等），并与设定的目标值进行比较，根据比较结果触发自动扩缩容操作。

### 2. 关键组件与术语

- 指标类型
  - **CPU 和内存指标**：是最常用的指标，Kubernetes 可以直接获取容器的 CPU 和内存使用情况。
  - **自定义指标**：可以是应用程序特定的指标，如请求每秒数（QPS）、队列长度等。需要借助外部的监控系统和适配器来提供这些指标给 Kubernetes。
- **目标值**：定义了期望的指标目标，例如，CPU 使用率目标设置为 50%，表示希望应用程序的平均 CPU 使用率维持在 50% 左右。
- 扩缩容策略
  - **扩容策略**：当指标超过目标值时，HPA 会按照一定的算法增加 Pod 副本数量。
  - **缩容策略**：当指标低于目标值时，HPA 会减少 Pod 副本数量，但为了避免频繁缩容，通常会设置一些延迟和阈值。